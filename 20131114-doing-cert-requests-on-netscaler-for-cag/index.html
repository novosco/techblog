<!DOCTYPE html>
<html dir='ltr' lang='en' xmlns:fb='http://ogp.me/ns/fb#'>
<head>
<link href="../stylesheets/syntax_highlighting.css?1439193430" media="screen" rel="stylesheet" type="text/css" />
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<meta content='text/html;' http-equiv='content-type'>
<title>Doing cert requests on NetScaler for CAG
 | Novosco Tech Blog</title>
<meta content='index,follow' name='robots'>
<meta content='initial-scale=1.0 maximum-scale=1.0 user-scalable=no' name='viewport'>
<meta content='width=380, maximum-scale=1.0' name='viewport'>
<link href='/favicon.ico' rel='shortcut icon' type='image/x-icon'>
<link href='../images/touch-icon-iphone.png' rel='apple-touch-icon'>
<link href='../images/touch-icon-ipad.png' rel='apple-touch-icon' sizes='72x72'>
<link href='../images/touch-icon-iphone-retina.png' rel='apple-touch-icon' sizes='114x114'>
<link href='../images/touch-icon-ipad-retina.png' rel='apple-touch-icon' sizes='144x144'>
<!--[if lt IE 9]> <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script> <![endif]-->
<link href="../stylesheets/all.css?1439193430" media="screen" rel="stylesheet" type="text/css" />
<!-- OG -->
<meta content='Novosco Tech Blog' property='og:title'>
<meta content='website' property='og:type'>
<meta content='../images/novosco-og-icon.png' property='og:image'>
<meta content='http://engineering.novosco.com' property='og:url'>
<meta content='Novosco Tech Blog ' property='og:description'>
<!-- Twitter -->
<meta content='summary' name='twitter:card'>
<meta content='http://engineering.novosco.com' name='twitter:url'>
<meta content='Novosco Tech Blog' name='twitter:title'>
<meta content='Novosco Tech Blog ' name='twitter:description'>
<meta content='../images/novosco-og-icon.png' name='twitter:image'>
<meta content='@novoscoeng' name='twitter:site'>
<meta content='@novosco' name='twitter:creator'>
<meta content='' name='author'>
<!-- Typekit -->
<script src="//use.typekit.net/tjm4emr.js" type="text/javascript"></script>
<script>
  try{Typekit.load();}catch(e){};
  
  window.onload = function() {
    var menu = document.getElementById('menu-button');
    var menu_items = document.getElementById('menu-items');
  
    function toggleMenu(){
      if (menu_items.style.display == "block") {
        menu_items.style.display = 'none';
      } else {
        menu_items.style.display = 'block';
      }
    };
  
    menu.addEventListener('click', function() {
      toggleMenu()
    }, false);
  };
</script>

</head>
<body class='20131114-doing-cert-requests-on-netscaler-for-cag 20131114-doing-cert-requests-on-netscaler-for-cag_index'>
<header>
<div class='layout-wrapper'>
<div class='layout-inner'>
<a href="/"><span class='logo'>Novosco Tech Blog</span></a>
<div class='header-nav'>
<nav>
<a href='#' id='menu-button'>
MENU
<img src='/images/menu-triangle.png' width='11px'>
</a>
<ul id='menu-items'>
<li>
<a href="http://www.novosco.com/">Home</a>
</li>
<li>
<a class="active" href="http://cio.novosco.com/">CIO Blog</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
</header>

<div class='container'>
<div id='post-main'>
<article class='post-header'>
<h1 class='article-header'>
<a href="/20131114-doing-cert-requests-on-netscaler-for-cag/">Doing cert requests on NetScaler for CAG</a>
</h1>
<div class='post-meta'>
<div class='post-avatar'>
<img src="../images/avatars/colin-rainey.jpg?1439193430" />
</div>
<div class='post-meta-text'>
<span>By <a href="/colin-rainey">Colin Rainey</a> on</span>
<time>14 November 2013</time>
</div>
</div>

<div class='body'>
<p>When setting up a virtual CAG on NetScaler – you can apply a certificate in a couple of different ways.</p>

<p>One option is to use IIS and request the certificate, return the request from the vendor and then use openssl on the IIS server, to convert the IIS to .PEM format.</p>

<p></p>

<p>Another option is to use the NetScaler admin tools to generate the request. To do this, you first must have your NetScaler license applied.</p>

<p>When requesting a cert from the NetScaler you have to generate a private key file. This is attached in the code of the cert request file, and then used to verify the source when you re-import.</p>

<p>You can also use a wildcard certificate. This is likely to be one that is used in other web servers so it’s important you know the private key password so you can import. You may also have to carry out the openssl conversion on IIS server before you can use on the NetScaler.</p>

<p>NetScaler can of course host multiple CAG vm, and act as a proxy for other internal sites –as well as perform SSL of loading for secure site traffic – so you could have more than one certificate on NetScaler.</p>

<p>I’m going to create my certificate request on the NetScaler using the admin gui.</p>

<ul>
<li>Go to Traffic Management and SSL – look for Create RSA Key</li>
<li>This prompts for filename – which is held on the NetScaler file system.</li>
<li>Give the file a name, a bit size – usually 2048 and then format – PEM and Encoding DES.</li>
<li>Enter a passphrase and then confirm this – make sure you record it or use a familiar phrase.</li>
<li>You can check the location of the file using Manage Certificates – which lists the folder location of the certificate and key files.</li>
<li>Next, generate the certificate request using Create CSR.</li>
<li>In the next screen, enter the details of the cert request as shown here.</li>
<li>Give the cert request a name – and Browse to the key file.</li>
<li>Enter the passphrase, and fill in the Distinguished Name Fields.</li>
</ul>

<p>Make sure that the cert or domain name you are requesting is actually associated with the company.</p>

<p>This can cause issues if the company name is not precise – so worth checking the domain in a whois lookup.</p>

<p>Also make sure you enter the fields marked “*” – an error will prompt you if you miss any. Also, before going to site – do the cert request at least a week in advance – it can take several days to get certs approved by some vendors in relation to government organisations for example.</p>

<p>When confirmed, click OK – then go into Manage Certificates to locate the request.</p>

<p>At this stage, you will need to either download the file OR select View and copy the text.</p>

<p>Your request is now ready to be submitted to a certificate authority.</p>

<p>On return, download the certificate and.</p>

<p>You should also apply the intermediate certificate chain and link it to your main cert.</p>

<p>To do this, get the intermediate cert from the vendor, and save to local folder.</p>

<ul>
<li>Click on Install and browse to the folder – give the intermediate cert a name eg DaddyBundle, and click on Create then Close.</li>
<li>In the main cert screen – you can then right click on main CAG cert and select Link – then select the DaddyBundle.</li>
<li> Click ok</li>
<li>You can now assign the ssl cert to your virtual CAG.</li>
</ul>

<p>The process is pretty easy once you do it a few times, so do practice it before you go to site or get stuck with a support call.</p>

<p><strong>References:</strong></p>

<p><strong>Generate SSL Cert Request</strong></p>

<p><a href="http://support.citrix.com/article/CTX109260">http://support.citrix.com/article/CTX109260</a></p>

<p><strong>Converting CAG pfx to PEM</strong></p>

<p><a href="http://support.citrix.com/article/ctx106028">http://support.citrix.com/article/ctx106028</a></p>

<p><strong>OpenSSL Commands</strong></p>

<p>Convert a DER file (.crt .cer .der) to PEM</p>

<p>openssl x509 -inform der -in certificate.cer -out certificate.pem</p>

<p>When converting from IIS – you need to import on the IIS server you generated the request from  – otherwise export with key will fail.</p>

<p>Convert a PEM file to DER</p>

<p>openssl x509 -outform der -in certificate.pem -out certificate.der</p>

<p>Convert a PKCS#12 file (.pfx .p12) containing a private key and certificates to PEM</p>

<p>openssl pkcs12 -in keyStore.pfx -out keyStore.pem -nodes</p>

<div class='tags'>
<ol>
<li><a class="tag" href="/netscaler/">Netscaler</a></li>
</ol>
</div>
<section class='post-footer'>
<h1 class='small-h1 post-author-header'>
<div class='post-author clearfix'>
<div class='author-avatar'>
<img src="../images/avatars/colin-rainey.jpg?1439193430" />
</div>
<div class='post-author-details'>
<h1><a href="/colin-rainey">Colin Rainey</a></h1>
<span class='bio'>Citrix Techie and IT enthusiast, delving into MDM and has been known to listen to the odd 80’s tune.</span>
<span class='author-posts-link'>
<a href="/colin-rainey">View Colin's other posts</a>
</span>
</div>
</div>
</h1>
</section>
<div class='post-nav'>
<div class='previous-post'>
<a href="/20131112-backing-up-netscaler/">← Previous</a>
</div>
<div class='next-post'>
<a href="/20131115-the-stateless-desktop-part-2/">Next →</a>
</div>
</div>
</div>
</article>
</div>
</div>
<footer>
<section class='newsletter'>
<div class='layout-wrapper' id='mc-signup'>
<div class='layout-inner'>
<form action='http://novosco.us7.list-manage1.com/subscribe/post?u=9bff1bb397f0ed0fda92caa1a&amp;id=b15b8e54dd' class='validate' id='mc-subscribe-form' method='post' name='mc-embedded-subscribe-form' novalidate='' target='_blank'>
<div class='form-inputs'>
<label for='mc-email'>
<div class='newsletter-title'>
Subscribe to our mailing list
</div>
<input id='mc-email' name='EMAIL' placeholder='Enter your email address…' required='' type='email' value=''>
</label>
</div>
<div class='form-action newsletter-button'>
<input class='button' name='subscribe' type='submit' value='Subscribe'>
</div>
</form>
</div>
</div>
</section>
<section class='footer-info clearfix'>
<div class='layout-wrapper'>
<div class='layout-inner'>
<span class='about-novosco'>
<strong>Novosco</strong>
is a leading provider of Cloud Technologies, Managed Service and Consulting.
</span>
<span class='copyright'>
© 2007-2015 Novosco Ltd
</span>
</div>
</div>
</section>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-44792610-1', 'novosco.com');
  ga('send', 'pageview');
</script>

</body>
</html>
