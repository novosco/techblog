<!DOCTYPE html>
<html dir='ltr' lang='en' xmlns:fb='http://ogp.me/ns/fb#'>
<head>
<link href="../stylesheets/syntax_highlighting.css?1439193430" media="screen" rel="stylesheet" type="text/css" />
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<meta content='text/html;' http-equiv='content-type'>
<title>Creating Cluster Resources for Exchange 2007 SCC
 | Novosco Tech Blog</title>
<meta content='index,follow' name='robots'>
<meta content='initial-scale=1.0 maximum-scale=1.0 user-scalable=no' name='viewport'>
<meta content='width=380, maximum-scale=1.0' name='viewport'>
<link href='/favicon.ico' rel='shortcut icon' type='image/x-icon'>
<link href='../images/touch-icon-iphone.png' rel='apple-touch-icon'>
<link href='../images/touch-icon-ipad.png' rel='apple-touch-icon' sizes='72x72'>
<link href='../images/touch-icon-iphone-retina.png' rel='apple-touch-icon' sizes='114x114'>
<link href='../images/touch-icon-ipad-retina.png' rel='apple-touch-icon' sizes='144x144'>
<!--[if lt IE 9]> <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script> <![endif]-->
<link href="../stylesheets/all.css?1439193430" media="screen" rel="stylesheet" type="text/css" />
<!-- OG -->
<meta content='Novosco Tech Blog' property='og:title'>
<meta content='website' property='og:type'>
<meta content='../images/novosco-og-icon.png' property='og:image'>
<meta content='http://engineering.novosco.com' property='og:url'>
<meta content='Novosco Tech Blog ' property='og:description'>
<!-- Twitter -->
<meta content='summary' name='twitter:card'>
<meta content='http://engineering.novosco.com' name='twitter:url'>
<meta content='Novosco Tech Blog' name='twitter:title'>
<meta content='Novosco Tech Blog ' name='twitter:description'>
<meta content='../images/novosco-og-icon.png' name='twitter:image'>
<meta content='@novoscoeng' name='twitter:site'>
<meta content='@novosco' name='twitter:creator'>
<meta content='' name='author'>
<!-- Typekit -->
<script src="//use.typekit.net/tjm4emr.js" type="text/javascript"></script>
<script>
  try{Typekit.load();}catch(e){};
  
  window.onload = function() {
    var menu = document.getElementById('menu-button');
    var menu_items = document.getElementById('menu-items');
  
    function toggleMenu(){
      if (menu_items.style.display == "block") {
        menu_items.style.display = 'none';
      } else {
        menu_items.style.display = 'block';
      }
    };
  
    menu.addEventListener('click', function() {
      toggleMenu()
    }, false);
  };
</script>

</head>
<body class='20130404-creating-cluster-resources-for-exchange-2007-scc 20130404-creating-cluster-resources-for-exchange-2007-scc_index'>
<header>
<div class='layout-wrapper'>
<div class='layout-inner'>
<a href="/"><span class='logo'>Novosco Tech Blog</span></a>
<div class='header-nav'>
<nav>
<a href='#' id='menu-button'>
MENU
<img src='/images/menu-triangle.png' width='11px'>
</a>
<ul id='menu-items'>
<li>
<a href="http://www.novosco.com/">Home</a>
</li>
<li>
<a class="active" href="http://cio.novosco.com/">CIO Blog</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
</header>

<div class='container'>
<div id='post-main'>
<article class='post-header'>
<h1 class='article-header'>
<a href="/20130404-creating-cluster-resources-for-exchange-2007-scc/">Creating Cluster Resources for Exchange 2007 SCC</a>
</h1>
<div class='post-meta'>
<div class='post-avatar'>
<img src="../images/avatars/alan-mcburney.jpg?1439193430" />
</div>
<div class='post-meta-text'>
<span>By <a href="/alan-mcburney">Alan McBurney</a> on</span>
<time> 4 April 2013</time>
</div>
</div>

<div class='body'>
<p>During a large scale Exchange migration for 2007 to 2010 an issue arose with Public Folder databases.</p>

<p>A public folder replica has been added to the Exchange 2007 servers to include the new 2010 environment.</p>

<p>After verification of data replication all 2007 databases were updated to have their public folder database point to the 2010 servers and the 2007 server removed from the replica in lieu of completely removing the 2007 public folders.</p>

<p></p>

<p>After a few weeks of normal usage users started reporting that they could no longer access their public folders.</p>

<p>To cut a long story short it was decided to add a replica back into Exchange 2007, as the Public Database was now removed I tried to recreate a new one.</p>

<p>Exchange 2007 is running as a Single Copy Cluster and requires cluster dependencies for normal operation.</p>

<p>As 2010 has been introduced into the environment Exchange 2007 throws an error upon creating the Database</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image1.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb1.png?w=244&h=141" /> </a></p>

<p>After checking the EMC the database has actually been created but at this point it fails to mount due to the missing cluster resource records</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image2.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb2.png?w=244&h=112" /> </a></p>

<p>To get the database to successfully mount we need to revert to the Cluster Administrator and create a new resource</p>

<p>Open the Cluster Administrator and Ctrl+N to open the new resource wizard</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image3.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb3.png?w=244&h=198" /> </a></p>

<p>Next select the possible owners</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image4.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb4.png?w=244&h=197" /> </a></p>

<p>And finally the dependencies. I chose Exchange Information Store and the Logs and Database drives</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image5.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb5.png?w=244&h=196" /> </a></p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image6.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb6.png?w=244&h=91" /> </a></p>

<p>I also change the Cluster Resource so that if it fails to come online it doesn’t affect the group which would result in a cluster failover</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image7.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb7.png?w=241&h=244" /> </a></p>

<p>This is only half the story as at this point the database will still not mount.</p>

<p>The next thing that needs to happen is that the Storage Group &amp; Database GUID need to be retrieved. This can be done using the Exchange Shell</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image8.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb8.png?w=244&h=79" /> </a></p>

<p>We need to register these GUIDs against the private properties of the cluster resource</p>

<p>To do this we need to drop to the command prompt</p>

<p><strong>Cluster.exe res “Public Folders”</strong> displays the properties of the resource</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/snaghtml9d1a8a4.png"> <img title="SNAGHTML9d1a8a4" alt="SNAGHTML9d1a8a4" src="http://everythingsysadmin.files.wordpress.com/2013/04/snaghtml9d1a8a4_thumb.png?w=244&h=42" /> </a></p>

<p><strong>Cluster.exe res “Public Folders”</strong> displays the private properties of the resource which is what we are interested in.</p>

<p>What needs to happen now is that the private resources needs to be assigned to the Cluster Resource</p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image9.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb9.png?w=244&h=32" /> </a></p>

<p><a href="http://everythingsysadmin.files.wordpress.com/2013/04/image10.png"> <img title="image" alt="image" src="http://everythingsysadmin.files.wordpress.com/2013/04/image_thumb10.png?w=244&h=44" /> </a></p>

<p>In both of the above screenshots the network name has been blanked out</p>

<p>We are now finally in a position to mount the public folder and the Cluster is fully operational again.</p>

<p>This process will work for any database not just public folders.</p>

<p><a href="http://feeds.wordpress.com/1.0/gocomments/everythingsysadmin.wordpress.com/565/"> <img src="http://feeds.wordpress.com/1.0/comments/everythingsysadmin.wordpress.com/565/" /> </a> <img src="http://stats.wordpress.com/b.gif?host=everythingsysadmin.wordpress.com&blog=8998607&post=565&subd=everythingsysadmin&ref=&feed=1" /></p>

<div class='tags'>
<ol>
<li><a class="tag" href="/uncategorized/">Uncategorized</a></li>
</ol>
</div>
<section class='post-footer'>
<h1 class='small-h1 post-author-header'>
<div class='post-author clearfix'>
<div class='author-avatar'>
<img src="../images/avatars/alan-mcburney.jpg?1439193430" />
</div>
<div class='post-author-details'>
<h1><a href="/alan-mcburney">Alan McBurney</a></h1>
<span class='bio'>Solutions Architect @Novosco. Passionate about technology, delivering Microsoft centric solutions with emphasis on Lync, Exchange, PowerShell and Infrastructure.</span>
<span class='author-posts-link'>
<a href="/alan-mcburney">View Alan's other posts</a>
</span>
</div>
</div>
</h1>
</section>
<div class='post-nav'>
<div class='previous-post'>
<a href="/20130403-exchange-2013-cu1-installation/">← Previous</a>
</div>
<div class='next-post'>
<a href="/20130408-vnxe-3100-with-esxi-using-iscsi-lets-clear-up-the-confusion/">Next →</a>
</div>
</div>
</div>
</article>
</div>
</div>
<footer>
<section class='newsletter'>
<div class='layout-wrapper' id='mc-signup'>
<div class='layout-inner'>
<form action='http://novosco.us7.list-manage1.com/subscribe/post?u=9bff1bb397f0ed0fda92caa1a&amp;id=b15b8e54dd' class='validate' id='mc-subscribe-form' method='post' name='mc-embedded-subscribe-form' novalidate='' target='_blank'>
<div class='form-inputs'>
<label for='mc-email'>
<div class='newsletter-title'>
Subscribe to our mailing list
</div>
<input id='mc-email' name='EMAIL' placeholder='Enter your email address…' required='' type='email' value=''>
</label>
</div>
<div class='form-action newsletter-button'>
<input class='button' name='subscribe' type='submit' value='Subscribe'>
</div>
</form>
</div>
</div>
</section>
<section class='footer-info clearfix'>
<div class='layout-wrapper'>
<div class='layout-inner'>
<span class='about-novosco'>
<strong>Novosco</strong>
is a leading provider of Cloud Technologies, Managed Service and Consulting.
</span>
<span class='copyright'>
© 2007-2015 Novosco Ltd
</span>
</div>
</div>
</section>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-44792610-1', 'novosco.com');
  ga('send', 'pageview');
</script>

</body>
</html>
